---
# iDRAC provisioning role for Dell servers
# Uses Redfish API to mount virtual media and boot
# Includes retry logic if installation fails

- name: Set installation attempt counter
  set_fact:
    install_attempt: 1
    max_attempts: 3

- name: Include installation tasks
  include_tasks: install.yml
  loop: "{{ range(1, (max_attempts | int) + 1) | list }}"
  loop_control:
    loop_var: attempt_number
  when: (install_attempt | int) <= (max_attempts | int)
